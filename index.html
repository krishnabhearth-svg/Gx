<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üåæ Krishi ‚Ä¢ Semantic Ecological Search</title>
<style>
body{font-family:Arial,sans-serif;background:#fff;color:#222;margin:0;padding:0;text-align:center;}
.container{max-width:900px;margin:0 auto;padding:20px;}
input[type=text]{width:92%;max-width:450px;padding:14px;border:1px solid #ccc;border-radius:24px;font-size:1em;margin:15px 0;}
.question-box{background:#f0fff4;padding:20px;border-radius:12px;margin:20px 0;text-align:left;}
.question-title{font-size:1.3em;font-weight:600;margin-bottom:15px;color:#2d3748;}
.options-grid{display:grid;grid-template-columns:1fr;gap:10px;}
.option-btn{background:white;border:1px solid #e2e8f0;border-radius:12px;padding:12px;text-align:left;cursor:pointer;font-size:0.95em;}
.option-btn:hover{border-color:#48bb78;}
.option-btn.selected{background:#48bb78;color:white;border-color:#48bb78;}
.actions-box{background:#e8f5e8;padding:15px;border-radius:10px;margin:20px 0;text-align:left;}
.actions-title{font-size:1.2em;font-weight:600;margin-bottom:10px;}
.action-item{display:inline-block;background:white;padding:6px 14px;margin:4px 6px 4px 0;border-radius:16px;font-size:0.85em;}
.tabs{display:flex;flex-wrap:wrap;justify-content:center;gap:8px;margin:15px 0;}
.tab{padding:8px 16px;background:#e0e0e0;border:none;border-radius:20px;cursor:pointer;font-size:0.8em;}
.tab.active{background:#4CAF50;color:white;}
.panel{display:none;text-align:left;padding:15px;background:#fff;border-radius:8px;}
.panel.active{display:block;}
.instruction{color:#777;margin:10px 0;font-size:0.9em;}
.debug-panel{background:#f7fafc;border-radius:10px;padding:15px;margin:20px 0;font-size:0.85em;text-align:left;display:none;}
</style>
</head>
<body>
<div class="container">
  <h1>üåæ Krishi ‚Ä¢ Semantic Search</h1>
  
  <!-- STEP 0: INITIAL SEARCH -->
  <div id="step0">
    <input type="text" id="userQuery" placeholder="e.g., japan bottle, pollution vehicle, organic farming‚Ä¶" onkeypress="if(event.key==='Enter') startAnalysis()">
    <button onclick="startAnalysis()" style="background:#4CAF50;color:white;border:none;border-radius:24px;padding:12px 25px;font-size:1em;cursor:pointer;">Start Analysis</button>
    <p class="instruction">Enter any keyword to begin intelligent ecological analysis</p>
  </div>

  <!-- STEP 1: CONTEXT QUESTION -->
  <div class="question-box" id="step1" style="display:none;">
    <div class="question-title" id="contextQuestion">üéØ What's your main focus?</div>
    <div class="options-grid" id="contextOptions"></div>
  </div>

  <!-- STEP 2: APPROACH QUESTION -->
  <div class="question-box" id="step2" style="display:none;">
    <div class="question-title" id="approachQuestion">üîÑ How do you want to proceed?</div>
    <div class="options-grid" id="approachOptions"></div>
  </div>

  <!-- STEP 3: OUTCOME QUESTION -->
  <div class="question-box" id="step3" style="display:none;">
    <div class="question-title" id="outcomeQuestion">üí´ What outcome matters most?</div>
    <div class="options-grid" id="outcomeOptions"></div>
    <button onclick="generateResults()" style="background:#4CAF50;color:white;border:none;border-radius:20px;padding:12px 25px;font-size:1em;margin-top:15px;cursor:pointer;">Get Perfect Results ‚Üí</button>
  </div>

  <!-- RESULTS -->
  <div id="results" style="display:none;">
    <div class="actions-box">
      <div class="actions-title">Recommended Actions</div>
      <div id="actionItems"></div>
    </div>
    
    <div class="tabs" id="tabs">
      <button class="tab active" onclick="showTab('google')">Google</button>
      <button class="tab" onclick="showTab('scholar')">Scholar</button>
      <button class="tab" onclick="showTab('youtube')">YouTube</button>
      <button class="tab" onclick="showTab('kids')">Kids Wiki</button>
      <button class="tab" onclick="showTab('wiki')">Wikipedia</button>
      <button class="tab" onclick="showTab('amazon')">Amazon</button>
      <button class="tab" onclick="showTab('openlib')">OpenLibrary</button>
      <button class="tab" onclick="showTab('news')">News</button>
      <button class="tab" onclick="showTab('maps')">Maps</button>
    </div>

    <div id="panels">
      <div class="panel active" id="google"><a id="googleLink" target="_blank"></a></div>
      <div class="panel" id="scholar"><a id="scholarLink" target="_blank"></a></div>
      <div class="panel" id="youtube"><a id="youtubeLink" target="_blank"></a></div>
      <div class="panel" id="kids"><a id="kidsLink" target="_blank"></a></div>
      <div class="panel" id="wiki"><a id="wikiLink" target="_blank"></a></div>
      <div class="panel" id="amazon"><a id="amazonLink" target="_blank"></a></div>
      <div class="panel" id="openlib"><a id="openlibLink" target="_blank"></a></div>
      <div class="panel" id="news"><a id="newsLink" target="_blank"></a></div>
      <div class="panel" id="maps"><a id="mapsLink" target="_blank"></a></div>
    </div>

    <!-- Debug Panel (Hidden by default) -->
    <div class="debug-panel" id="debugPanel">
      <strong>üîç Search Analysis Details:</strong><br>
      <span id="debugContent">Click to expand</span>
    </div>
    <button onclick="toggleDebug()" style="background:#718096;color:white;border:none;border-radius:20px;padding:8px 16px;font-size:0.8em;margin-top:10px;cursor:pointer;">Details</button>
  </div>
</div>

<script>
// üåç SEMANTIC DATABASE (2MB-ready with ecological accounting)
const SEMANTIC_DB = {
  "organic farming": {
    questions: {
      context: {
        title: "üå± What aspect of organic farming?",
        options: {
          "home_garden": "üè† Home garden (small space)",
          "commercial": "üè¢ Commercial farming",
          "health": "üíö Health benefits",
          "environment": "üåç Environmental impact",
          "community": "üë• Community food security"
        }
      },
      approach: {
        title: "üõ†Ô∏è How do you want to get involved?",
        options: {
          "learn": "üìö Learn the basics",
          "practice": "üåø Start practicing",
          "community": "ü§ù Join community garden",
          "business": "üíº Start small business"
        }
      },
      outcome: {
        title: "üéØ What are you hoping to achieve?",
        options: {
          "healthy_food": "üçé Grow healthy food",
          "save_money": "üí∞ Save money on groceries",
          "environment": "üå± Help environment",
          "community": "üèòÔ∏è Build community",
          "skills": "üõ†Ô∏è Learn valuable skills"
        }
      }
    },
    actions: {
      "home_garden": ["Start small container garden", "Research local growing seasons", "Test soil pH"],
      "commercial": ["Visit organic farm", "Learn certification process", "Attend farming workshop"],
      "health": ["Learn about organic nutrition", "Join wellness group", "Start herb garden"],
      "environment": ["Plant native species", "Start composting", "Join conservation group"],
      "community": ["Join community garden", "Organize seed exchange", "Volunteer at local farm"]
    },
    ecological_accounting: {
      inputs: ["seeds", "water", "labor", "compost"],
      outputs: ["vegetables", "soil_health", "biodiversity", "seeds"],
      cruelty_index: 0.05,
      sustainability_score: 0.95
    }
  },
  "pollution vehicle": {
    questions: {
      context: {
        title: "üå´Ô∏è What pollution aspect concerns you?",
        options: {
          "air_quality": "üå¨Ô∏è Air quality impact",
          "health_effects": "üè• Health effects",
          "climate_impact": "üå°Ô∏è Climate change",
          "noise_pollution": "üîá Noise pollution"
        }
      },
      approach: {
        title: "üîÑ How do you want to address this?",
        options: {
          "personal_change": "üö∂ Personal change",
          "policy_advocacy": "üì¢ Policy advocacy",
          "tech_innovation": "üí° Tech innovation",
          "community_action": "üèòÔ∏è Community action"
        }
      },
      outcome: {
        title: "üéØ What outcome matters most?",
        options: {
          "cleaner_air": "üå¨Ô∏è Cleaner air",
          "health_protection": "‚ù§Ô∏è Health protection",
          "climate_action": "üåç Climate action",
          "economic_savings": "üí∞ Economic savings"
        }
      }
    },
    actions: {
      "air_quality": ["Research electric vehicles", "Use air purifier", "Join clean air group"],
      "health_effects": ["Calculate carbon footprint", "Support health studies", "Reduce car use"],
      "climate_impact": ["Switch to renewable energy", "Advocate for EV infrastructure", "Carbon offset"],
      "noise_pollution": ["Use quieter transport", "Support urban planning", "Plant noise barriers"]
    },
    ecological_accounting: {
      inputs: ["fuel", "metal", "road_infrastructure"],
      outputs: ["mobility", "economic_access", "pollution"],
      cruelty_index: 0.62,
      sustainability_score: 0.38
    }
  },
  "japan bottle": {
    questions: {
      context: {
        title: "üç∂ What aspect of Japan bottles?",
        options: {
          "plastic_waste": "üß¥ Plastic waste impact",
          "recycling": "‚ôªÔ∏è Recycling systems",
          "alternatives": "üå± Sustainable alternatives",
          "policy": "üèõÔ∏è Japan's environmental policies"
        }
      },
      approach: {
        title: "üîÑ How do you want to engage with this?",
        options: {
          "reduce": "üöØ Reduce single-use",
          "recycle": "‚ôªÔ∏è Improve recycling",
          "innovate": "üí° Find alternatives",
          "advocate": "üì¢ Policy advocacy"
        }
      },
      outcome: {
        title: "üéØ What outcome matters most?",
        options: {
          "waste_reduction": "üóëÔ∏è Reduce plastic waste",
          "circular_economy": "üîÑ Circular economy",
          "ocean_protection": "üåä Ocean protection",
          "community_action": "üèòÔ∏è Community clean-up"
        }
      }
    },
    actions: {
      "plastic_waste": ["Avoid single-use bottles", "Carry reusable bottle", "Support plastic-free stores"],
      "recycling": ["Learn Japan's recycling rules", "Find local collection", "Separate properly"],
      "alternatives": ["Use glass/metal bottles", "Support refill stations", "Make DIY containers"],
      "policy": ["Study Japan's container laws", "Support similar policies", "Join advocacy group"]
    },
    ecological_accounting: {
      inputs: ["plastic", "water", "energy"],
      outputs: ["waste", "pollution", "convenience"],
      cruelty_index: 0.45,
      sustainability_score: 0.25
    }
  },
  "fallback": {
    questions: {
      context: {
        title: "üåç What area are you exploring?",
        options: {
          "environment": "Environmental solutions",
          "health": "Health & wellness",
          "learning": "Learning & skills",
          "community": "Community development"
        }
      },
      approach: {
        title: "üîÑ How do you want to proceed?",
        options: {
          "learn": "Learn & understand",
          "action": "Take practical action",
          "community": "Join community efforts",
          "research": "Study & research"
        }
      },
      outcome: {
        title: "üí´ What outcome matters most?",
        options: {
          "personal": "Personal improvement",
          "community": "Community benefit",
          "environment": "Environmental impact",
          "knowledge": "Knowledge & understanding"
        }
      }
    },
    actions: {
      "environment": ["Research options", "Join environmental group", "Start small project"],
      "health": ["Learn wellness practices", "Connect with support", "Start daily routine"],
      "learning": ["Find online courses", "Join study group", "Practice daily"],
      "community": ["Volunteer locally", "Join community project", "Share knowledge"]
    },
    ecological_accounting: {
      inputs: ["time", "attention", "resources"],
      outputs: ["knowledge", "connection", "action"],
      cruelty_index: 0.1,
      sustainability_score: 0.7
    }
  }
};

let currentMatch = null;
let userAnswers = { context: null, approach: null, outcome: null };
let originalQuery = "";

function startAnalysis() {
  originalQuery = document.getElementById('userQuery').value.trim();
  if (!originalQuery) {
    alert("Please enter a search term");
    return;
  }

  // Find semantic match
  if (SEMANTIC_DB[originalQuery.toLowerCase()]) {
    currentMatch = SEMANTIC_DB[originalQuery.toLowerCase()];
  } else {
    // Try partial match
    let found = false;
    for (const [term, data] of Object.entries(SEMANTIC_DB)) {
      if (originalQuery.toLowerCase().includes(term) || term.includes(originalQuery.toLowerCase())) {
        currentMatch = data;
        found = true;
        break;
      }
    }
    if (!found) currentMatch = SEMANTIC_DB["fallback"];
  }

  // Show Step 1
  document.getElementById('step0').style.display = 'none';
  document.getElementById('step1').style.display = 'block';
  document.getElementById('contextQuestion').textContent = currentMatch.questions.context.title;
  
  const contextOptions = document.getElementById('contextOptions');
  contextOptions.innerHTML = '';
  Object.entries(currentMatch.questions.context.options).forEach(([value, text]) => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.textContent = text;
    btn.onclick = () => selectAnswer('context', value, btn);
    contextOptions.appendChild(btn);
  });
}

function selectAnswer(type, value, button) {
  // Clear selection
  const buttons = document.querySelectorAll(`.${type === 'context' ? 'step1' : type === 'approach' ? 'step2' : 'step3'} .option-btn`);
  buttons.forEach(btn => btn.classList.remove('selected'));
  
  // Select clicked
  button.classList.add('selected');
  
  // Store answer
  userAnswers[type] = value;
}

function nextStep(currentStep) {
  document.getElementById(`step${currentStep}`).style.display = 'none';
  document.getElementById(`step${currentStep + 1}`).style.display = 'block';
  
  if (currentStep === 1) {
    // Show approach question
    document.getElementById('approachQuestion').textContent = currentMatch.questions.approach.title;
    const approachOptions = document.getElementById('approachOptions');
    approachOptions.innerHTML = '';
    Object.entries(currentMatch.questions.approach.options).forEach(([value, text]) => {
      const btn = document.createElement('button');
      btn.className = 'option-btn';
      btn.textContent = text;
      btn.onclick = () => selectAnswer('approach', value, btn);
      approachOptions.appendChild(btn);
    });
  } else if (currentStep === 2) {
    // Show outcome question
    document.getElementById('outcomeQuestion').textContent = currentMatch.questions.outcome.title;
    const outcomeOptions = document.getElementById('outcomeOptions');
    outcomeOptions.innerHTML = '';
    Object.entries(currentMatch.questions.outcome.options).forEach(([value, text]) => {
      const btn = document.createElement('button');
      btn.className = 'option-btn';
      btn.textContent = text;
      btn.onclick = () => selectAnswer('outcome', value, btn);
      outcomeOptions.appendChild(btn);
    });
  }
}

function generateResults() {
  // Get actions based on user answers
  let actions = ["Research options", "Join relevant community", "Start with small steps"];
  if (currentMatch.actions && userAnswers.context && currentMatch.actions[userAnswers.context]) {
    actions = currentMatch.actions[userAnswers.context];
  }

  // Show results
  document.getElementById('step3').style.display = 'none';
  document.getElementById('results').style.display = 'block';
  
  // Display actions
  document.getElementById('actionItems').innerHTML = 
    actions.map(a => `<span class="action-item">${a}</span>`).join('');
  
  // Build final query from actions
  const finalQuery = `${originalQuery} ${actions.slice(0, 2).join(' ')}`;
  
  // Update all tabs
  updateSearchTabs(finalQuery, originalQuery);
  
  // Update debug info
  const accounting = currentMatch.ecological_accounting || {};
  document.getElementById('debugContent').innerHTML = `
    ‚Ä¢ Matched: "${currentMatch === SEMANTIC_DB["fallback"] ? 'Fallback' : originalQuery}"<br>
    ‚Ä¢ Context: ${userAnswers.context || 'general'}<br>
    ‚Ä¢ Approach: ${userAnswers.approach || 'general'}<br>
    ‚Ä¢ Outcome: ${userAnswers.outcome || 'general'}<br>
    ‚Ä¢ Final Query: "${finalQuery}"<br>
    ‚Ä¢ Ecological Accounting:<br>
    &nbsp;&nbsp;Inputs: ${accounting.inputs?.join(', ') || 'N/A'}<br>
    &nbsp;&nbsp;Outputs: ${accounting.outputs?.join(', ') || 'N/A'}<br>
    &nbsp;&nbsp;Cruelty Index: ${accounting.cruelty_index || 0}<br>
    &nbsp;&nbsp;Sustainability Score: ${accounting.sustainability_score || 0}
  `;
}

function updateSearchTabs(finalQuery, originalQuery) {
  const e = encodeURIComponent;
  
  document.getElementById('googleLink').href = `https://www.google.com/search?q=${e(finalQuery)}`;
  document.getElementById('googleLink').textContent = `Google: ${finalQuery}`;
  
  document.getElementById('scholarLink').href = `https://scholar.google.com/scholar?q=${e(finalQuery)}`;
  document.getElementById('scholarLink').textContent = `Scholar: ${finalQuery}`;
  
  document.getElementById('youtubeLink').href = `https://www.youtube.com/results?search_query=${e(finalQuery)}`;
  document.getElementById('youtubeLink').textContent = `YouTube: ${finalQuery}`;
  
  document.getElementById('kidsLink').href = `https://kids.miraheze.org/w/index.php?search=${e(finalQuery)}`;
  document.getElementById('kidsLink').textContent = `Kids Wiki: ${finalQuery}`;
  
  document.getElementById('wikiLink').href = `https://en.wikipedia.org/w/index.php?search=${e(finalQuery)}`;
  document.getElementById('wikiLink').textContent = `Wikipedia: ${finalQuery}`;
  
  document.getElementById('amazonLink').href = `https://www.amazon.com/s?k=${e(finalQuery)}`;
  document.getElementById('amazonLink').textContent = `Amazon: ${finalQuery}`;
  
  document.getElementById('openlibLink').href = `https://openlibrary.org/search?q=${e(finalQuery)}`;
  document.getElementById('openlibLink').textContent = `OpenLibrary: ${finalQuery}`;
  
  document.getElementById('newsLink').href = `https://news.google.com/search?q=${e(finalQuery)}`;
  document.getElementById('newsLink').textContent = `News: ${finalQuery}`;
  
  document.getElementById('mapsLink').href = `https://www.google.com/maps/search/${e(originalQuery)}`;
  document.getElementById('mapsLink').textContent = `Maps: ${originalQuery} resources`;
}

function showTab(tabId) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
  event.target.classList.add('active');
}

function toggleDebug() {
  const panel = document.getElementById('debugPanel');
  panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
}
</script>
</body>
</html>
