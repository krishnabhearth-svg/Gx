<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸŒ¾ Krishi â€¢ Intelligent 3-Step Semantic Search</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4efe9 100%);
            min-height: 100vh;
            color: #2d3748;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
        }

        .logo {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        h1 {
            font-size: 2.2rem;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #718096;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .search-box {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        #keywordInput {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s;
            outline: none;
        }

        #keywordInput:focus {
            border-color: #48bb78;
            box-shadow: 0 0 0 3px rgba(72, 187, 120, 0.1);
        }

        #analyzeBtn {
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        #analyzeBtn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .progress-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e2e8f0;
            margin: 0 8px;
            transition: all 0.3s;
        }

        .progress-dot.active {
            background: #48bb78;
            transform: scale(1.2);
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .step.active {
            display: block;
        }

        .question-box {
            background: #f0fff4;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #48bb78;
        }

        .question-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 16px 20px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .option-btn:hover {
            border-color: #48bb78;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }

        .option-btn.selected {
            background: #48bb78;
            color: white;
            border-color: #48bb78;
        }

        .next-btn {
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 20px auto 0;
        }

        .next-btn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .next-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }

        .results-container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
        }

        .results-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .query-display {
            background: #edf2f7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .original-query {
            color: #718096;
            margin-bottom: 5px;
        }

        .enhanced-query {
            font-weight: 600;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .actions-section {
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3748;
        }

        .action-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .action-item {
            background: #f0fff4;
            color: #276749;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid #c6f6d5;
        }

        .search-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab {
            background: #edf2f7;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: #48bb78;
            color: white;
        }

        .panel {
            display: none;
            text-align: center;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
        }

        .panel.active {
            display: block;
        }

        .panel a {
            color: #3182ce;
            text-decoration: none;
            font-weight: 500;
            display: inline-block;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .panel a:hover {
            background: #ebf8ff;
        }

        .reset-btn {
            background: #718096;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 30px auto 0;
        }

        .reset-btn:hover {
            background: #4a5568;
        }

        .semantic-info {
            background: #e6fffa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #234e52;
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .search-container, .results-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            #analyzeBtn {
                padding: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">ðŸŒ¾</div>
            <h1>Krishi Semantic Search</h1>
            <p class="subtitle">Enter any keyword and answer 3 simple questions for perfectly tailored ecological results</p>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container">
            <div class="progress-dot active" id="dot1"></div>
            <div class="progress-dot" id="dot2"></div>
            <div class="progress-dot" id="dot3"></div>
            <div class="progress-dot" id="dot4"></div>
        </div>

        <!-- Step 1: Keyword Input -->
        <div class="step active" id="step1">
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="keywordInput" placeholder="Enter any keyword (e.g., vehicle pollution, home garden, mental calm)â€¦">
                    <button id="analyzeBtn">Analyze & Continue â†’</button>
                </div>
                <div id="keywordAnalysis" class="semantic-info"></div>
            </div>
        </div>

        <!-- Step 2: Context Question -->
        <div class="step" id="step2">
            <div class="search-container">
                <div class="question-box">
                    <div class="question-title" id="question2Title">ðŸŽ¯ What's your main focus?</div>
                    <div class="options-grid" id="question2Options"></div>
                </div>
                <button class="next-btn" onclick="nextStep(2)" disabled>Next â†’</button>
            </div>
        </div>

        <!-- Step 3: Approach Question -->
        <div class="step" id="step3">
            <div class="search-container">
                <div class="question-box">
                    <div class="question-title" id="question3Title">ðŸ”„ How do you want to approach this?</div>
                    <div class="options-grid" id="question3Options"></div>
                </div>
                <button class="next-btn" onclick="nextStep(3)" disabled>Next â†’</button>
            </div>
        </div>

        <!-- Step 4: Outcome Question -->
        <div class="step" id="step4">
            <div class="search-container">
                <div class="question-box">
                    <div class="question-title" id="question4Title">ðŸ’« What outcome are you seeking?</div>
                    <div class="options-grid" id="question4Options"></div>
                </div>
                <button class="next-btn" onclick="generateFinalResults()">Get Perfect Results â†’</button>
            </div>
        </div>

        <!-- Results Section -->
        <div class="step" id="results">
            <div class="results-container">
                <div class="results-header">
                    <h2>ðŸŽ‰ Your Enhanced Ecological Search</h2>
                </div>

                <div class="query-display">
                    <div class="original-query">Original: "<span id="originalKeyword"></span>"</div>
                    <div class="enhanced-query">Enhanced: "<span id="finalQuery"></span>"</div>
                </div>

                <div class="semantic-info" id="matchInfo"></div>

                <div class="actions-section">
                    <div class="section-title">Recommended Actions</div>
                    <div class="action-items" id="actionItems"></div>
                </div>

                <div class="search-tabs">
                    <button class="tab active" onclick="showPanel('google')">Google</button>
                    <button class="tab" onclick="showPanel('youtube')">YouTube</button>
                    <button class="tab" onclick="showPanel('scholar')">Scholar</button>
                    <button class="tab" onclick="showPanel('amazon')">Amazon Books</button>
                    <button class="tab" onclick="showPanel('maps')">Local Resources</button>
                </div>

                <div class="panel active" id="google">
                    <a id="googleLink" target="_blank">Search on Google</a>
                </div>
                <div class="panel" id="youtube">
                    <a id="youtubeLink" target="_blank">Search on YouTube</a>
                </div>
                <div class="panel" id="scholar">
                    <a id="scholarLink" target="_blank">Search on Google Scholar</a>
                </div>
                <div class="panel" id="amazon">
                    <a id="amazonLink" target="_blank">Search on Amazon Books</a>
                </div>
                <div class="panel" id="maps">
                    <a id="mapsLink" target="_blank">Find Local Resources</a>
                </div>

                <button class="reset-btn" onclick="resetSearch()">Start New Search</button>
            </div>
        </div>
    </div>

    <script>
        // User data storage
        let userData = {
            keyword: "",
            semanticMatch: null,
            answers: {
                context: null,
                approach: null, 
                outcome: null
            }
        };

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('analyzeBtn').addEventListener('click', analyzeKeyword);
            document.getElementById('keywordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') analyzeKeyword();
            });
        });

        // Semantic analysis function
        function analyzeKeyword() {
            const keyword = document.getElementById('keywordInput').value.trim().toLowerCase();
            
            if (!keyword) {
                alert("Please enter a keyword to analyze");
                return;
            }

            userData.keyword = keyword;
            
            // Find best semantic match (simulated - will be replaced with actual semantic matching)
            const match = findSemanticMatch(keyword);
            userData.semanticMatch = match;
            
            // Show analysis info
            const analysisDiv = document.getElementById('keywordAnalysis');
            analysisDiv.innerHTML = `
                <strong>Analysis:</strong> "${keyword}" â†’ Best match: "${match.keyword}" (${match.source})<br>
                <strong>Domain:</strong> ${match.data.domain || 'General Ecological'}
            `;
            analysisDiv.style.display = 'block';
            
            // Move to next step
            nextStep(1);
            generateQuestions();
        }

        // Semantic matching function (placeholder - will be enhanced with your JSON database)
        function findSemanticMatch(keyword) {
            // This is a simplified version - will be replaced with your comprehensive semantic matching
            const semanticDatabase = {
                "vehicle pollution": {
                    domain: "TRANSPORT_ECOLOGY",
                    questions: {
                        context: {
                            title: "ðŸš— What aspect of vehicle pollution concerns you?",
                            options: {
                                "health_impact": "Health effects on people",
                                "environment": "Environmental damage", 
                                "solutions": "Clean transportation solutions"
                            }
                        },
                        approach: {
                            title: "ðŸ”„ How do you want to address this?",
                            options: {
                                "personal_action": "Take personal action",
                                "community": "Join community efforts", 
                                "research": "Learn & research solutions"
                            }
                        },
                        outcome: {
                            title: "ðŸ’« What's your desired outcome?",
                            options: {
                                "clean_air": "Cleaner air in my community",
                                "healthier_life": "Healthier lifestyle",
                                "cost_savings": "Save money on transport"
                            }
                        }
                    },
                    base_actions: ["Calculate carbon footprint", "Use public transport", "Research electric vehicles"],
                    modifiers: {
                        health_impact: "health effects respiratory",
                        environment: "environmental impact ecosystem",
                        solutions: "clean alternatives sustainable"
                    }
                },
                "organic farming": {
                    domain: "AGRICULTURE",
                    questions: {
                        context: {
                            title: "ðŸŒ± What interests you about organic farming?",
                            options: {
                                "home_garden": "Starting home garden",
                                "commercial": "Commercial farming", 
                                "health": "Health benefits"
                            }
                        },
                        approach: {
                            title: "ðŸ› ï¸ How do you want to get involved?",
                            options: {
                                "learn": "Learn the basics",
                                "practice": "Start practicing", 
                                "community": "Join community garden"
                            }
                        },
                        outcome: {
                            title: "ðŸŽ¯ What are you hoping to achieve?",
                            options: {
                                "healthy_food": "Grow healthy food",
                                "save_money": "Save money on groceries",
                                "environment": "Help environment"
                            }
                        }
                    },
                    base_actions: ["Start small garden", "Learn composting", "Test soil quality"],
                    modifiers: {
                        home_garden: "home gardening beginners",
                        commercial: "commercial scale business",
                        health: "health benefits nutrition"
                    }
                },
                "mental health": {
                    domain: "WELLNESS",
                    questions: {
                        context: {
                            title: "ðŸ˜Š What aspect of mental health?",
                            options: {
                                "stress": "Stress management",
                                "anxiety": "Anxiety relief", 
                                "mindfulness": "Mindfulness & peace"
                            }
                        },
                        approach: {
                            title: "ðŸŒ¿ How do you prefer to approach wellness?",
                            options: {
                                "self_care": "Self-care practices",
                                "professional": "Professional help", 
                                "community": "Community support"
                            }
                        },
                        outcome: {
                            title: "ðŸ’« What wellness outcome do you seek?",
                            options: {
                                "peace": "Inner peace & calm",
                                "energy": "More energy & motivation",
                                "clarity": "Mental clarity & focus"
                            }
                        }
                    },
                    base_actions: ["Practice daily mindfulness", "Connect with nature", "Join support community"],
                    modifiers: {
                        stress: "stress relief management",
                        anxiety: "anxiety reduction techniques", 
                        mindfulness: "mindfulness practice meditation"
                    }
                }
            };

            // Direct match
            if (semanticDatabase[keyword]) {
                return { keyword: keyword, data: semanticDatabase[keyword], source: "exact match" };
            }

            // Word similarity match
            for (const [dbKeyword, data] of Object.entries(semanticDatabase)) {
                const keywordWords = keyword.split(' ');
                const dbKeywordWords = dbKeyword.split(' ');
                
                const matches = keywordWords.filter(kw => 
                    dbKeywordWords.some(dbw => kw.includes(dbw) || dbw.includes(kw))
                );
                
                if (matches.length > 0) {
                    return { keyword: dbKeyword, data: data, source: "semantic match" };
                }
            }

            // Contextual fallback
            if (keyword.includes('car') || keyword.includes('vehicle') || keyword.includes('pollution')) {
                return { keyword: "vehicle pollution", data: semanticDatabase["vehicle pollution"], source: "contextual fallback" };
            }
            if (keyword.includes('farm') || keyword.includes('garden') || keyword.includes('organic')) {
                return { keyword: "organic farming", data: semanticDatabase["organic farming"], source: "contextual fallback" };
            }
            if (keyword.includes('mental') || keyword.includes('stress') || keyword.includes('anxiety')) {
                return { keyword: "mental health", data: semanticDatabase["mental health"], source: "contextual fallback" };
            }

            // Ultimate fallback
            return { keyword: "organic farming", data: semanticDatabase["organic farming"], source: "general fallback" };
        }

        // Generate questions based on semantic match
        function generateQuestions() {
            const match = userData.semanticMatch;
            const questions = match.data.questions;
            
            // Question 2: Context
            document.getElementById('question2Title').textContent = questions.context.title;
            const options2 = document.getElementById('question2Options');
            options2.innerHTML = '';
            Object.entries(questions.context.options).forEach(([value, text]) => {
                options2.innerHTML += `<button class="option-btn" onclick="selectAnswer(2, '${value}')">${text}</button>`;
            });

            // Question 3: Approach
            document.getElementById('question3Title').textContent = questions.approach.title;
            const options3 = document.getElementById('question3Options');
            options3.innerHTML = '';
            Object.entries(questions.approach.options).forEach(([value, text]) => {
                options3.innerHTML += `<button class="option-btn" onclick="selectAnswer(3, '${value}')">${text}</button>`;
            });

            // Question 4: Outcome
            document.getElementById('question4Title').textContent = questions.outcome.title;
            const options4 = document.getElementById('question4Options');
            options4.innerHTML = '';
            Object.entries(questions.outcome.options).forEach(([value, text]) => {
                options4.innerHTML += `<button class="option-btn" onclick="selectAnswer(4, '${value}')">${text}</button>`;
            });
        }

        // Handle answer selection
        function selectAnswer(step, value) {
            // Remove selected class from all buttons in current step
            const currentStep = document.getElementById(`step${step}`);
            const buttons = currentStep.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            // Add selected class to clicked button
            event.target.classList.add('selected');
            
            // Store answer
            if (step === 2) userData.answers.context = value;
            if (step === 3) userData.answers.approach = value;
            if (step === 4) userData.answers.outcome = value;
            
            // Enable next button
            const nextBtn = currentStep.querySelector('.next-btn');
            nextBtn.disabled = false;
        }

        // Navigate to next step
        function nextStep(currentStep) {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step${currentStep + 1}`).classList.add('active');
            
            // Update progress dots
            document.querySelectorAll('.progress-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index < currentStep + 1);
            });
        }

        // Generate final results
        function generateFinalResults() {
            document.getElementById('step4').classList.remove('active');
            document.getElementById('results').classList.add('active');
            document.querySelectorAll('.progress-dot').forEach(dot => dot.classList.add('active'));

            const match = userData.semanticMatch;
            
            // Generate enhanced query
            const enhancedQuery = buildEnhancedQuery();
            
            // Display results
            document.getElementById('originalKeyword').textContent = userData.keyword;
            document.getElementById('finalQuery').textContent = enhancedQuery;
            document.getElementById('matchInfo').textContent = `Matched: "${match.keyword}" (${match.source}) | Domain: ${match.data.domain}`;
            document.getElementById('matchInfo').style.display = 'block';
            
            // Generate actions
            const actions = generateActions();
            document.getElementById('actionItems').innerHTML = 
                actions.map(action => `<div class="action-item">${action}</div>`).join('');

            // Update search links
            updateSearchLinks(enhancedQuery);
        }

        // Build enhanced query based on user answers
        function buildEnhancedQuery() {
            const match = userData.semanticMatch;
            const answers = userData.answers;
            
            let query = userData.keyword;
            
            // Add context modifier
            if (match.data.modifiers && match.data.modifiers[answers.context]) {
                query += ' ' + match.data.modifiers[answers.context];
            }
            
            // Add ecological context
            query += ' sustainable ecological solutions';
            
            return query;
        }

        // Generate actions based on user answers
        function generateActions() {
            const match = userData.semanticMatch;
            const answers = userData.answers;
            
            let actions = [...match.data.base_actions];
            
            // Add context-specific actions
            if (answers.context === 'health_impact' || answers.context === 'health') {
                actions.push('Monitor air quality', 'Use pollution mask when needed');
            }
            if (answers.context === 'home_garden') {
                actions.push('Start with herbs', 'Use kitchen waste for compost');
            }
            if (answers.context === 'stress' || answers.context === 'anxiety') {
                actions.push('Practice breathing exercises', 'Create calm space at home');
            }
            
            // Add approach-specific actions
            if (answers.approach === 'community') {
                actions.push('Find local groups', 'Attend community events');
            }
            if (answers.approach === 'learn' || answers.approach === 'research') {
                actions.push('Read latest research', 'Take online course');
            }
            
            return actions.slice(0, 5);
        }

        // Update search links with enhanced query
        function updateSearchLinks(enhancedQuery) {
            const e = encodeURIComponent;
            
            document.getElementById('googleLink').href = `https://www.google.com/search?q=${e(enhancedQuery)}`;
            document.getElementById('googleLink').textContent = `Google: ${enhancedQuery}`;
            
            document.getElementById('youtubeLink').href = `https://www.youtube.com/results?search_query=${e(enhancedQuery + ' tutorial')}`;
            document.getElementById('youtubeLink').textContent = `YouTube: ${enhancedQuery} tutorials`;
            
            document.getElementById('scholarLink').href = `https://scholar.google.com/scholar?q=${e(enhancedQuery)}`;
            document.getElementById('scholarLink').textContent = `Scholar: ${enhancedQuery} research`;
            
            document.getElementById('amazonLink').href = `https://www.amazon.com/s?k=${e(enhancedQuery + ' books')}`;
            document.getElementById('amazonLink').textContent = `Amazon: ${enhancedQuery} books`;
            
            document.getElementById('mapsLink').href = `https://www.google.com/maps/search/${e(userData.keyword)}`;
            document.getElementById('mapsLink').textContent = `Maps: Local ${userData.keyword} resources`;
        }

        // Show specific panel in results
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(panel => panel.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
            event.target.classList.add('active');
        }

        // Reset the entire search process
        function resetSearch() {
            userData = { keyword: "", semanticMatch: null, answers: { context: null, approach: null, outcome: null } };
            document.getElementById('keywordInput').value = '';
            document.getElementById('keywordAnalysis').style.display = 'none';
            document.getElementById('matchInfo').style.display = 'none';
            
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelectorAll('.next-btn').forEach(btn => btn.disabled = true);
            document.querySelectorAll('.progress-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === 0);
            });
            
            document.getElementById('step1').classList.add('active');
        }
    </script>
</body>
</html>
